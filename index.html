<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ูุธุงู ุงุณุชุนูุงู ุงูุทุงูุจ</title>

<style>

/* =========================
   ุฎูููุฉ โ ุฃุฒุฑู ูููู
========================= */
body {
    font-family: 'Cairo', sans-serif;
    direction: rtl;
    background: linear-gradient(135deg, #00e1ff, #007bff);
    background-size: 300% 300%;
    animation: neonBg 8s infinite alternate ease-in-out;
    margin: 0;
    padding-bottom: 120px;
}
@keyframes neonBg { 0%{background-position:0% 50%} 100%{background-position:100% 50%} }

/* =========================
   Splash Screen
========================= */
#splash {
    position: fixed;
    inset: 0;
    background: white;
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    animation: splashFadeOut 3.4s forwards;
}
@keyframes splashFadeOut { 0%,70%{opacity:1;} 100%{opacity:0;visibility:hidden;} }
.splash-title { font-size: 30px; font-weight:bold; color:#007bff; }

/* =========================
   Header
========================= */
header {
    text-align: center;
    padding: 20px;
    font-size: 22px;
    color: white;
    font-weight: bold;
    opacity: 0;
    animation: fadeIn 1.4s 3.2s forwards;
}
@keyframes fadeIn { to { opacity: 1; } }

/* =========================
   Login Box
========================= */
.login-box {
    width: 85%;
    max-width: 340px;
    margin: 140px auto 0;
    text-align: center;
}
.login-box input,
.login-box button {
    width: 100%;
    padding: 13px;
    font-size: 17px;
    border-radius: 14px;
    border: none;
    margin-top: 14px;
}

/* ุญูู ุงูุฅุฏุฎุงู */
.login-box input {
    background: white;
    color: #0060c9;
    font-weight: bold;
}

/* ุฒุฑ ุชุณุฌูู ุงูุฏุฎูู (ุฃุฎุถุฑ ูุจููุณ ุงูุญุฌู) */
.login-box button {
    background: linear-gradient(135deg, #19e05a, #0a9b32);
    color: white;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(10,155,50,0.35);
    transition: 0.25s;
}
.login-box button:hover {
    transform: scale(1.04);
    box-shadow: 0 6px 16px rgba(10,155,50,0.45);
}
.error { color: yellow; font-weight: bold; }

/* =========================
   Pages
========================= */
.page { display: none; }

.section {
    padding: 15px;
    margin: 20px;
    border-radius: 18px;
    background: rgba(255,255,255,0.4);
    backdrop-filter: blur(16px);
    color: #004a99;
    font-weight: bold;
}

/* =========================
   Tables
========================= */
table { width: 100%; border-collapse: collapse; }
td, th {
    padding: 12px;
    border-bottom: 1px solid rgba(255,255,255,0.4);
}
.table-input {
    width: 100%;
    padding: 10px;
    border-radius: 12px;
    border: none;
    background: rgba(255,255,255,0.75);
    color: #004a99;
}
.table-input.hasDate {
    color: #002855;
    font-weight: bold;
}

/* =========================
   Action Buttons (profile)
========================= */
.profile-actions {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}
.logout-btn, .save-btn {
    flex: 1;
    padding: 12px;
    border-radius: 12px;
    border: none;
    font-weight: bold;
    color: white;
    cursor: pointer;
}
.logout-btn { background:#ff1744; }
.save-btn { background:#ffd600; color:black; }

/* =========================
   Bottom Navigation
========================= */
#bottomBar {
    position: fixed;
    bottom: 18px;
    left: 50%;
    transform: translateX(-50%) translateY(100%);
    width: 92%;
    height: 70px;
    display: none;
    justify-content: space-around;
    align-items: center;
    border-radius: 30px;
    background: rgba(255,255,255,0.25);
    backdrop-filter: blur(18px);
    border: 1px solid rgba(255,255,255,0.35);
    box-shadow:0 5px 20px rgba(0,0,0,0.25);
    transition:0.8s;
    color:#004a99;
}
#bottomBar.show-bar { transform: translateX(-50%) translateY(0); }

.nav-item { cursor:pointer; opacity:.7; font-weight:bold; position:relative; }
.nav-item:hover { opacity:1; }

.burst {
    position:absolute;
    width:12px;
    height:12px;
    background:white;
    border-radius:50%;
    transform:translate(-50%,-50%) scale(0);
    animation:burstAnim .5s forwards;
}
@keyframes burstAnim {
    0%{transform:translate(-50%,-50%) scale(0);opacity:1;}
    100%{transform:translate(-50%,-50%) scale(15);opacity:0;}
}

/* =========================
   ุจุทุงูุงุช ุงูุฏุฑุฌุงุช (ุฎุถุฑุงุก)
========================= */
.grade-card {
    background: linear-gradient(135deg, #00c853, #009624);
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 16px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.25);
    color: white;
}
.grade-title {
    font-size: 19px;
    margin-bottom: 10px;
    color: #ffffff;
    border-bottom: 2px solid rgba(255,255,255,0.6);
    padding-bottom: 6px;
}
.grade-row {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
    font-size: 14px;
    border-bottom: 1px solid rgba(255,255,255,0.35);
    color: #f5f5f5;
}
.grade-row:last-child { border-bottom: none; }

.objection-btn {
    width: 100%;
    padding: 10px;
    margin-top: 12px;
    background: #00e676;
    color: #004d40;
    border: none;
    border-radius: 12px;
    font-weight: bold;
    cursor: pointer;
}

/* ุจุทุงูุฉ ูุนูููุงุช ุงูุบูุงุจ ูุงูููุงุญุธุงุช */
.grades-info-card {
    margin-top: 20px;
    background: rgba(255,255,255,0.9);
    padding: 14px;
    border-radius: 16px;
    box-shadow: 0 3px 12px rgba(0,0,0,0.16);
    font-size: 14px;
    color: #003f7d;
}
.grades-info-card p { margin: 4px 0; }

</style>
</head>

<body>

<!-- Splash -->
<div id="splash">
    <div class="splash-title">ูุณู ุงูุญูููุฉ</div>
    <div class="splash-sub">ุซุงูููุฉ ุงูุชุญุฏู ุงูุฃูููุฉ</div>
    <div class="splash-year">ุงูุนุงู ุงูุฏุฑุงุณู 2025 - 2026</div>
</div>

<header>๐ ูุธุงู ุงุณุชุนูุงู ุงูุทุงูุจ</header>

<!-- Login -->
<div class="login-box" id="loginBox">
    <input id="studentCode" placeholder="ุฃุฏุฎู ููุฏ ุงูุทุงูุจ">
    <button onclick="searchStudent()">ุชุณุฌูู ุงูุฏุฎูู</button>
    <div id="output"></div>
</div>

<!-- Pages -->
<div id="profilePage" class="page section"></div>
<div id="gradesPage" class="page section">ูุง ุชูุฌุฏ ุฏุฑุฌุงุช ุญุงููุงู</div>
<div id="notifyPage" class="page section">ูุง ุชูุฌุฏ ุชุจููุบุงุช ุญุงููุงู</div>
<div id="chatPage" class="page section">ูุง ุชูุฌุฏ ุฑุณุงุฆู ุญุงููุงู</div>

<!-- Bottom Bar -->
<div id="bottomBar">
    <div class="nav-item" onclick="showPage('profilePage', this)">ุงูููู ุงูุดุฎุตู</div>
    <div class="nav-item" onclick="showPage('gradesPage', this)">ุงูุฏุฑุฌุงุช</div>
    <div class="nav-item" onclick="showPage('notifyPage', this)">ุงูุชุจููุบุงุช</div>
    <div class="nav-item" onclick="showPage('chatPage', this)">ุงูุฏุฑุฏุดุฉ</div>
</div>

<script>

/* ุฑุงุจุท API */
const API_URL = "https://script.google.com/macros/s/AKfycbxn5f4smL2SYZ8BkFKdOZzRoZdugC4fHycSO7VEJi4JLAD8X1-pOCZneYLqGL3GuVFf/exec";

/* =========================
   ุงูุฏุฎูู ุงูุชููุงุฆู ุจุนุฏ ุฅุนุงุฏุฉ ูุชุญ ุงูุตูุญุฉ
========================= */
window.addEventListener("DOMContentLoaded", () => {
    let savedCode = localStorage.getItem("studentCode");
    let isLoggedIn = localStorage.getItem("loggedIn");

    if (isLoggedIn === "true" && savedCode) {
        document.getElementById("studentCode").value = savedCode;
        searchStudent(false); // ูุง ูุนูุฏ ุญูุธ ุงูุฌูุณุฉ ููุง ูุญุฏูุซ ุงูุญุงูุฉ
    }
});

/* =========================
   ุฅุตูุงุญ ุงูุชุงุฑูุฎ ุงููุงุฏู ูู ุงูุดูุช
========================= */
function fixDate(dateStr) {
    if (!dateStr) return "";

    dateStr = dateStr.replace(/[ู-ูฉ]/g, d => "0123456789"["ููกูขูฃูคูฅูฆูงูจูฉ".indexOf(d)]);

    let parsed = Date.parse(dateStr);
    if (!isNaN(parsed)) {
        let d = new Date(parsed);
        let yyyy = d.getFullYear();
        let mm = String(d.getMonth()+1).padStart(2,'0');
        let dd = String(d.getDate()).padStart(2,'0');
        return `${yyyy}-${mm}-${dd}`;
    }

    return "";
}

/* =========================
   ุชุญุฏูุซ ุญุงูุฉ ุงูุทุงูุจ: ุชุณุฌูู/ุฎุฑูุฌ
========================= */
async function updateState(code, state) {
    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
            action: "update_state",
            code: code,
            state: state
        })
    });
}

/* =========================
   ุชุณุฌูู ุงูุฏุฎูู
========================= */
async function searchStudent(saveSession = true) {

    let code = document.getElementById("studentCode").value.trim();
    let output = document.getElementById("output");

    if (!code) {
        output.innerHTML = "<p class='error'>โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงูููุฏ</p>";
        return;
    }

    output.innerHTML = `<p style="color:white">โณ ุฌุงุฑู ุงูุชุญููู...</p>`;

    try {
        let res = await fetch(`${API_URL}?code=${code}`);
        let data = await res.json();

        if (data.status !== "success") {
            output.innerHTML = `<p class='error'>โ ${data.data}</p>`;
            return;
        }

        let student = data.data;

        if (saveSession) {
            localStorage.setItem("loggedIn", "true");
            localStorage.setItem("studentCode", code);
            updateState(code, "ุชู ุงูุชุณุฌูู");
        }

        document.getElementById("loginBox").style.display = "none";
        document.getElementById("bottomBar").style.display = "flex";
        document.getElementById("bottomBar").classList.add("show-bar");

        loadProfile(student);
        loadGrades(student);

    } catch (err) {
        output.innerHTML = `<p class="error">โ ุฎุทุฃ ูู ุงูุงุชุตุงู</p>`;
    }
}

/* =========================
   ุงูููู ุงูุดุฎุตู
========================= */
function loadProfile(student) {

    const code = student["ููุฏ ุงูุทุงูุจ"] || "";

    document.getElementById("profilePage").innerHTML = `

    <div class="profile-actions">
        <button onclick="logout()" class="logout-btn">๐ ุฎุฑูุฌ</button>
        <button onclick="saveChanges('${code}')" class="save-btn">๐พ ุญูุธ</button>
    </div>

    <h3>๐ ุงูููู ุงูุดุฎุตู</h3>

    <table>

      <tr><th>ID</th><td>${student["id"] || ""}</td></tr>

      <tr><th>ุงุณู ุงูุทุงูุจ</th><td>${student["ุงุณู ุงูุทุงูุจ"] || ""}</td></tr>

      <tr>
          <th>ุงูููุงููุฏ</th>
          <td>
              <input 
                  type="date" 
                  class="table-input" 
                  id="ุงูููุงููุฏ"
                  min="1960-01-01"
                  max="2027-12-31"
                  value="${ fixDate(student["ุงูููุงููุฏ"]) }"
                  onchange="this.classList.add('hasDate')"
              >
          </td>
      </tr>

      <tr><th>ุงูุตู</th><td>${student["ุงูุตู"] || ""}</td></tr>
      <tr><th>ุงููุงุนุฉ</th><td>${student["ุงููุงุนุฉ"] || ""}</td></tr>
      <tr><th>ุงูุฌูุณ</th><td>${student["ุงูุฌูุณ"] || ""}</td></tr>

      <tr><th>ุฑูู ููู ุงูุฃูุฑ</th>
      <td><input class="table-input" id="ุฑูู ููู ุงูุงูุฑ" value="${student["ุฑูู ููู ุงูุงูุฑ"] || ""}"></td></tr>

      <tr><th>ุฑูู ุงูุฎุท</th>
      <td><input class="table-input" id="ุฑูู ุงูุฎุท" value="${student["ุฑูู ุงูุฎุท"] || ""}"></td></tr>

      <tr><th>ููุฏ ุงูุทุงูุจ</th><td>${student["ููุฏ ุงูุทุงูุจ"] || ""}</td></tr>

      <tr><th>ุฑูู ุงูุทุงูุจ</th>
      <td><input class="table-input" id="ุฑูู ุงูุทุงูุจ" value="${student["ุฑูู ุงูุทุงูุจ"] || ""}"></td></tr>

      <tr><th>ุงููุชุจ</th><td>${student["ุงููุชุจ"] || ""}</td></tr>

      <tr><th>ุงูุนููุงู</th>
      <td><input class="table-input" id="ุงูุนููุงู" value="${student["ุงูุนููุงู"] || ""}"></td></tr>

      <tr><th>ุงุณู ุงูุฃู</th>
      <td><input class="table-input" id="ุงุณู ุงูุงู" value="${student["ุงุณู ุงูุงู"] || ""}"></td></tr>

      <tr><th>ุงููุฏุฑุณุฉ ุงููุงุฏู ูููุง</th>
      <td><input class="table-input" id="ุงููุฏุฑุณุฉ ุงููุงุฏู ูููุง" value="${student["ุงููุฏุฑุณุฉ ุงููุงุฏู ูููุง"] || ""}"></td></tr>

      <tr><th>ุงููุนุฏู</th><td>${student["ุงููุนุฏู ูู ุงูุตู ุงูุณุงุจู"] || ""}</td></tr>

      <tr><th>ุงูููุงุญุธุงุช</th><td>${student["ุงูููุงุญุธุงุช"] || ""}</td></tr>

      <tr><th>ุงูุฑูุฒ</th>
      <td><input class="table-input" id="ุงูุฑูุฒ" value="${student["ุงูุฑูุฒ"] || ""}"></td></tr>

    </table>
    `;

    showPage("profilePage");
}

/* =========================
   ุญูุธ ุงูุชุนุฏููุงุช
========================= */
async function saveChanges(code) {

    const data = {
        "ุงูููุงููุฏ": document.getElementById("ุงูููุงููุฏ").value,
        "ุฑูู ููู ุงูุงูุฑ": document.getElementById("ุฑูู ููู ุงูุงูุฑ").value,
        "ุฑูู ุงูุฎุท": document.getElementById("ุฑูู ุงูุฎุท").value,
        "ุฑูู ุงูุทุงูุจ": document.getElementById("ุฑูู ุงูุทุงูุจ").value,
        "ุงูุนููุงู": document.getElementById("ุงูุนููุงู").value,
        "ุงุณู ุงูุงู": document.getElementById("ุงุณู ุงูุงู").value,
        "ุงููุฏุฑุณุฉ ุงููุงุฏู ูููุง": document.getElementById("ุงููุฏุฑุณุฉ ุงููุงุฏู ูููุง").value,
        "ุงูุฑูุฒ": document.getElementById("ุงูุฑูุฒ").value
    };

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
            action: "update",
            code: code,
            data: data
        })
    });

    alert("โ ุชู ุญูุธ ุงูุชุนุฏููุงุช");
}

/* =========================
   ุชุญุฏูุฏ ุนููุฏ ุงูุงุนุชุฑุงุถ ุญุณุจ ุงููุงุฏุฉ
========================= */
function getObjectionColumn(subject) {
    const map = {
        "ุงูุฅุณูุงููุฉ": "ุงูุงุนุชุฑุงุถุงุช ุงูุงุณูุงููุฉ",
        "ุงูุนุฑุจู": "ุงูุงุนุชุฑุงุถ ุนุฑุจู",
        "ุงูุงููููุฒู": "ุงูุงุนุชุฑุงุถ ุงููููุฒู",
        "ุงูุฑูุงุถูุงุช": "ุงูุงุนุชุฑุงุถ ุฑูุงุถูุงุช",
        "ุงูููููุงุก": "ุงูุงุนุชุฑุงุถ ููููุงุก",
        "ุงูููุฒูุงุก": "ุงูุงุนุชุฑุงุถ ููุฒูุงุก",
        "ุงูุงุญูุงุก": "ุงูุงุนุชุฑุงุถ ุงุญูุงุก",
        "ุงูุงุฌุชูุงุนูุงุช": "ุงูุงุนุชุฑุงุถ ุงูุงุฌุชูุงุนูุงุช",
        "ุงูุญุงุณูุจ": "ุงูุงุนุชุฑุงุถ ุงูุญุงุณูุจ",
        "ุฑูุงุถุฉ": "ุงูุงุนุชุฑุงุถ ุฑูุงุถุฉ",
        "ุงููููุฉ": "ุงูุงุนุชุฑุงุถ ูููุฉ",
        "ุงูุณููู": "ุงูุงุนุชุฑุงุถ ุงูุณููู"
    };
    return map[subject] || "";
}

/* =========================
   ุฅุฑุณุงู ุงูุงุนุชุฑุงุถ ุฅูู ุงูุดูุช
========================= */
async function sendObjection(code, column, subjectName) {

    if (!column) {
        alert("โ ูุง ููุฌุฏ ุนููุฏ ุงุนุชุฑุงุถ ูุฑุชุจุท ุจูุฐู ุงููุงุฏุฉ");
        return;
    }

    const value = subjectName; // ููุชุจ ููุท ุงุณู ุงููุงุฏุฉ

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
            action: "update",
            code: code,
            data: { [column]: value }
        })
    });

    alert("โ ุชู ุชุณุฌูู ุงุนุชุฑุงุถู ุนูู ูุงุฏุฉ " + subjectName);
}

/* =========================
   ุตูุญุฉ ุงูุฏุฑุฌุงุช
========================= */
function loadGrades(st) {

    const code = st["ููุฏ ุงูุทุงูุจ"] || "";

    let html = ``;

    const subjects = {
        "ุงูุฅุณูุงููุฉ": [
            "ุงุณูุงููุฉ ุดูุฑ 1","ุงุณูุงููุฉ ุดูุฑ 2","ุงุณูุงููุฉ ูุตู 1","ุงุณูุงููุฉ ูุตู ุณูุฉ",
            "ุงุณูุงููุฉ ุดูุฑ 3","ุงุณูุงููุฉ ุดูุฑ 4","ุงุณูุงููุฉ ูุตู 2","ุงุณูุงููุฉ ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงุณูุงููุฉ ุงูุณุนู","ุงุณูุงููุฉ ุงูุชูุฏูุฑ"
        ],
        "ุงูุนุฑุจู": [
            "ุงูุนุฑุจู ุดูุฑ 1","ุงูุนุฑุจู ุดูุฑ 2","ุงูุนุฑุจู ูุตู 1","ุงูุนุฑุจู ูุตู ุณูุฉ",
            "ุงูุนุฑุจู ุดูุฑ 3","ุงูุนุฑุจู ุดูุฑ 4","ุงูุนุฑุจู ูุตู 2","ุงูุนุฑุจู ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูุนุฑุจู ุงูุณุนู","ุงูุนุฑุจู ุงูุชูุฏูุฑ"
        ],
        "ุงูุงููููุฒู": [
            "ุงูุงููููุฒู ุดูุฑ 1","ุงูุงููููุฒู ุดูุฑ 2","ุงูุงููููุฒู ูุตู 1","ุงูุงููููุฒู ูุตู ุณูุฉ",
            "ุงูุงููููุฒู ุดูุฑ 3","ุงูุงููููุฒู ุดูุฑ 4","ุงูุงููููุฒู ูุตู 2","ุงูุงููููุฒู ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูุงููููุฒู ุงูุณุนู","ุงูุงููููุฒู ุงูุชูุฏูุฑ"
        ],
        "ุงูุฑูุงุถูุงุช": [
            "ุงูุฑูุงุถูุงุช ุดูุฑ 1","ุงูุฑูุงุถูุงุช ุดูุฑ 2","ุงูุฑูุงุถูุงุช ูุตู 1","ุงูุฑูุงุถูุงุช ูุตู ุณูุฉ",
            "ุงูุฑูุงุถูุงุช ุดูุฑ 3","ุงูุฑูุงุถูุงุช ุดูุฑ 4","ุงูุฑูุงุถูุงุช ูุตู 2","ุงูุฑูุงุถูุงุช ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูุฑูุงุถูุงุช ุงูุณุนู","ุงูุฑูุงุถูุงุช ุงูุชูุฏูุฑ"
        ],
        "ุงูููููุงุก": [
            "ุงูููููุงุก ุดูุฑ 1","ุงูููููุงุก ุดูุฑ 2","ุงูููููุงุก ูุตู 1","ุงูููููุงุก ูุตู ุณูุฉ",
            "ุงูููููุงุก ุดูุฑ 3","ุงูููููุงุก ุดูุฑ 4","ุงูููููุงุก ูุตู 2","ุงูููููุงุก ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูููููุงุก ุงูุณุนู","ุงูููููุงุก ุงูุชูุฏูุฑ"
        ],
        "ุงูููุฒูุงุก": [
            "ุงูููุฒูุงุก ุดูุฑ 1","ุงูููุฒูุงุก ุดูุฑ 2","ุงูููุฒูุงุก ูุตู 1","ุงูููุฒูุงุก ูุตู ุณูุฉ",
            "ุงูููุฒูุงุก ุดูุฑ 3","ุงูููุฒูุงุก ุดูุฑ 4","ุงูููุฒูุงุก ูุตู 2","ุงูููุฒูุงุก ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูููุฒูุงุก ุงูุณุนู","ุงูููุฒูุงุก ุงูุชูุฏูุฑ"
        ],
        "ุงูุงุญูุงุก": [
            "ุงูุงุญูุงุก ุดูุฑ 1","ุงูุงุญูุงุก ุดูุฑ 2","ุงูุงุญูุงุก ูุตู 1","ุงูุงุญูุงุก ูุตู ุณูุฉ",
            "ุงูุงุญูุงุก ุดูุฑ 3","ุงูุงุญูุงุก ุดูุฑ 4","ุงูุงุญูุงุก ูุตู 2","ุงูุงุญูุงุก ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูุงุญูุงุก ุงูุณุนู","ุงูุงุญูุงุก ุงูุชูุฏูุฑ"
        ],
        "ุงูุงุฌุชูุงุนูุงุช": [
            "ุงูุงุฌุชูุงุนูุงุช ุดูุฑ 1","ุงูุงุฌุชูุงุนูุงุช ุดูุฑ 2","ุงูุงุฌุชูุงุนูุงุช ูุตู 1","ุงูุงุฌุชูุงุนูุงุช ูุตู ุณูุฉ",
            "ุงูุงุฌุชูุงุนูุงุช ุดูุฑ 3","ุงูุงุฌุชูุงุนูุงุช ุดูุฑ 4","ุงูุงุฌุชูุงุนูุงุช ูุตู 2","ุงูุงุฌุชูุงุนูุงุช ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูุงุฌุชูุงุนูุงุช ุงูุณุนู","ุงูุงุฌุชูุงุนูุงุช ุงูุชูุฏูุฑ"
        ],
        "ุงูุญุงุณูุจ": [
            "ุงูุญุงุณูุจ ุดูุฑ 1","ุงูุญุงุณูุจ ุดูุฑ 2","ุงูุญุงุณูุจ ูุตู 1","ุงูุญุงุณูุจ ูุตู ุณูุฉ",
            "ุงูุญุงุณูุจ ุดูุฑ 3","ุงูุญุงุณูุจ ุดูุฑ 4","ุงูุญุงุณูุจ ูุตู 2","ุงูุญุงุณูุจ ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูุญุงุณูุจ ุงูุณุนู","ุงูุญุงุณูุจ ุงูุชูุฏูุฑ"
        ],
        "ุฑูุงุถุฉ": [
            "ุฑูุงุถุฉ ุดูุฑ 1","ุฑูุงุถุฉ ุดูุฑ 2","ุฑูุงุถุฉ ูุตู 1","ุฑูุงุถุฉ ูุตู ุณูุฉ",
            "ุฑูุงุถุฉ ุดูุฑ 3","ุฑูุงุถุฉ ุดูุฑ 4","ุฑูุงุถุฉ ูุตู 2","ุฑูุงุถุฉ ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุฑูุงุถุฉ ุงูุณุนู","ุฑูุงุถุฉ ุงูุชูุฏูุฑ"
        ],
        "ุงููููุฉ": [
            "ุงููููุฉ ุดูุฑ 1","ุงููููุฉ ุดูุฑ 2","ุงููููุฉ ูุตู 1","ุงููููุฉ ูุตู ุณูุฉ",
            "ุงููููุฉ ุดูุฑ 3","ุงููููุฉ ุดูุฑ 4","ุงููููุฉ ูุตู 2","ุงููููุฉ ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงููููุฉ ุงูุณุนู","ุงููููุฉ ุงูุชูุฏูุฑ"
        ],
        "ุงูุณููู": [
            "ุงูุณููู ุดูุฑ 1","ุงูุณููู ุดูุฑ 2","ุงูุณููู ูุตู 1","ุงูุณููู ูุตู ุณูุฉ",
            "ุงูุณููู ุดูุฑ 3","ุงูุณููู ุดูุฑ 4","ุงูุณููู ูุตู 2","ุงูุณููู ุงูุงูุชุญุงู ุงูููุงุฆู",
            "ุงูุณููู ุงูุณุนู","ุงูุณููู ุงูุชูุฏูุฑ"
        ]
    };

    for (let sub in subjects) {

        html += `
        <div class="grade-card">
            <div class="grade-title">${sub}</div>
        `;

        subjects[sub].forEach(col => {
            html += `
                <div class="grade-row">
                    <span>${col}</span>
                    <span>${st[col] || "-"}</span>
                </div>
            `;
        });

        const colName = getObjectionColumn(sub);

        html += `
            <button class="objection-btn"
                onclick="sendObjection('${code}', '${colName}', '${sub}')">
                ุงุนุชุฑุถ ุนูู ูุงุฏุฉ ${sub}
            </button>

        </div>
        `;
    }

    html += `
        <div class="grades-info-card">
            <p>๐ต ุงูุบูุงุจ: <b>${st["ุงูุบูุงุจ"] || "-"}</b></p>
            <p>๐ต ุงุฎุชูุงู ูุดุงูู ุฏุงุฎู ุงููุฏุฑุณุฉ: <b>${st["ุงุฎุชูุงู ูุดุงูู ุฏุงุฎู ุงููุฏุฑุณุฉ"] || "-"}</b></p>
            <p>๐ต ููุงุญุธุงุช ูุฑุช: <b>${st["ููุงุญุธุงุช ูุฑุช"] || "-"}</b></p>
            <p>๐ต ููุงุญุธุงุช ุงููุชูุฌุฉ: <b>${st["ููุงุญุธุงุช ุงููุชูุฌุฉ"] || "-"}</b></p>
        </div>
    `;

    document.getElementById("gradesPage").innerHTML = html;
}

/* =========================
   ุชุณุฌูู ุงูุฎุฑูุฌ
========================= */
function logout() {

    const code = localStorage.getItem("studentCode");

    if (code) {
        updateState(code, "ุฎุฑุฌ");
    }

    localStorage.removeItem("loggedIn");
    localStorage.removeItem("studentCode");
    location.reload();
}

/* =========================
   Navigation + Animation
========================= */
function showPage(pageId, element = null) {

    document.querySelectorAll(".page").forEach(p => p.style.display = "none");

    document.getElementById(pageId).style.display = "block";

    document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));

    if (element) {
        element.classList.add("active");

        let burst = document.createElement("span");
        burst.classList.add("burst");
        burst.style.left = "50%";
        burst.style.top = "50%";
        element.appendChild(burst);

        setTimeout(() => burst.remove(), 500);
    }
}

</script>

</body>
</html>
